<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>全家饮食规划 - 益家AiFamily</title>
    <link rel="stylesheet" href="/static/css/xialakimi.css">
    <link rel="stylesheet" href="/static/css/peican.css">
</head>
<body>
    <!-- 遮罩层 (初始在屏幕外) -->
    <div id="pullOverlay"></div>
    <!-- 顶部隐藏面板 -->
    <div id="hiddenPanel">
<!-- ========== 今日营养仪表盘 ========== -->
        <div id="nutritionDash" class="nutrition-dash">
          <div class="dash-inner">
            <h4 class="dash-title">
              <span class="icon-lightning">⚡</span>今天还差多少？
              <button id="miniRefresh" class="mini-refresh" title="重新计算">↻</button>
            </h4>
            <ul class="dash-bars">
              <li data-nutrient="calories"><span class="bar-label">能量</span><span class="bar"><i></i></span><span class="val">0%</span></li>
              <li data-nutrient="protein"><span class="bar-label">蛋白</span><span class="bar"><i></i></span><span class="val">0%</span></li>
              <li data-nutrient="calcium"><span class="bar-label">钙</span><span class="bar"><i></i></span><span class="val">0%</span></li>
              <li data-nutrient="iron"><span class="bar-label">铁</span><span class="bar"><i></i></span><span class="val">0%</span></li>
              <li data-nutrient="sodium"><span class="bar-label">钠</span><span class="bar"><i></i></span><span class="val">0%</span></li>
              <li data-nutrient="fat"><span class="bar-label">脂肪</span><span class="bar"><i></i></span><span class="val">0%</span></li>
            </ul>
          </div>
        </div>
        <button id="closePanelBtn" class="panel-close-btn">收起</button>
    </div>
        <!-- 头部模块 -->
        <section class="my-header">
            <div class="guard-content">
                <div class="gap-line">
                    <span class="gap-tag">钙<span class="gap-value"><progress value="3" max="8"></progress></span></span>
                    <span class="gap-tag">铁<span class="gap-value"><progress value="3" max="8"></progress></span></span>
                    <span class="gap-tag">蛋白<span class="gap-value"><progress value="3" max="8"></progress></span></span>
                </div>
            </div>
            <button id="toggleArrow" class="arrow-btn">↓</button>
        </section>

    <div id="mainContent" class="container">
        <!-- 成就提示 -->
        <div class="achievement-toast" id="achievementToast"></div>
        <section class="smart-guard-bar">
        <div class="guard-content">
            <div class="member-line">
            </div>
        </div>
        </section>

<!-- ===== 今日组合（幻灯片版） ===== -->
          <!-- 主内容区 -->
  <main class="main-content">
<section id="comboSection" class="combo-section">
  <div style="display: flex;justify-content:space-between; align-items:center;">
      <h2 class="combo-title"><p id="mealTimeSubtitle"></p></h2>
    <div id="openmore" class="more">更多设置</div>
  </div>
        <!-- 第一部分：饮食方案 -->
    <div class="preference-section">
        <div class="solution-tags" id="solutionTags">
            <div class="solution-line">
                <span class="solution-tag active" data-solution="lowFat">低脂✓</span>
                <span class="solution-tag active" data-solution="highIron">补铁✓</span>
                <span class="solution-tag active" data-solution="highCalcium">高钙✓</span>
                <span class="solution-tag active" data-solution="lowSalt">限盐✓</span>
            </div>
        </div>
    </div>
    <!-- 第二部分：过敏源 -->
    <div class="preference-section">
        <div class="filter-options">
            <label class="filter-checkbox">
                <input type="checkbox" id="excludeAllergens">
                <span class="checkmark"></span>
                <span class="filter-label">排除过敏源</span>
                <span class="filter-detail" id="allergensDetail"></span>
            </label>
            <label class="filter-checkbox">
                <input type="checkbox" id="excludeTaboo">
                <span class="checkmark"></span>
                <span class="filter-label">排除忌口</span>
                <span class="filter-detail" id="tabooDetail"></span>
            </label>

        </div>

    </div>
    <!-- 分隔线 -->
    <div class="divider"></div>
    <!-- 更多 -->
    <div id="overlaymore" style="display:none;">
    <div class="preference-section" id="popupmore">
        <div class="filter-options">
            <label class="filter-checkbox">
            <input type="checkbox" id="seasonalOnly">
            <span class="checkmark"></span>
            <span class="filter-label">仅当季食材</span>
            </label>
        </div>
        <div class="budget-selector">
            <label class="budget-option">
                <input type="radio" name="budgetLevel" value="low">
                <span class="budget-btn">经济型</span>
            </label>
            <label class="budget-option">
                <input type="radio" name="budgetLevel" value="medium" checked>
                <span class="budget-btn">标准型</span>
            </label>
            <label class="budget-option">
                <input type="radio" name="budgetLevel" value="high">
                <span class="budget-btn">豪华型</span>
            </label>
        </div>
        <div class="budget-selector">
            <label class="budget-option">
                <input type="radio" name="budgetLevel" value="low">
                <span class="budget-btn">快手菜</span>
            </label>
            <label class="budget-option">
                <input type="radio" name="budgetLevel" value="medium" checked>
                <span class="budget-btn">日常菜</span>
            </label>
            <label class="budget-option">
                <input type="radio" name="budgetLevel" value="high">
                <span class="budget-btn">功夫菜</span>
            </label>
        </div>
        <div class="divider"></div>
        <div class="budget-selector">
            <label class="budget-option">
                <input type="radio" name="budgetLevel" value="low">
                <span class="budget-btn">轻松</span>
            </label>
            <label class="budget-option">
                <input type="radio" name="budgetLevel" value="medium" checked>
                <span class="budget-btn">标准</span>
            </label>
            <label class="budget-option">
                <input type="radio" name="budgetLevel" value="high">
                <span class="budget-btn">高强度</span>
            </label>
        </div>
        <button id="closeBtnmore">&times;</button>
    </div>
    </div>

  <!-- 精选套餐 -->
  <!-- 每个 combo 占一行 -->
  <div id="combos" class="combo-list">
    <!-- JS 会填充这里 -->
  </div>
</section>
      <section class="combo-section">
      <!-- 尝尝鲜：同级、一行 3 菜 -->
  <div class="taste-row">
    <h3 class="combo-name">尝尝鲜</h3>
    <div class="dish-list" id="tasteRowList">
      <!-- JS 动态生成 3 个尝鲜菜 -->
    </div>
    <button class="refresh-taste-inline" id="refreshTasteInline">↻ 换一批</button>
  </div>
</section>
      <section class="combo-section">
      <!-- 近期吃过 -->
<div class="taste-row">
  <h3 class="combo-name">近期吃过</h3>
    <div class="dish-list" id="historyTrack">
      <!-- JS 动态生成 -->
    </div>
</div>
      </section>
  </main>

<!-- ===== 营养提篮（悬浮） ===== -->
<div id="nutritionBasket" class="nutrition-basket">
  <div class="basket-info">
    <span id="basketCount">已选 0 道菜</span>
          <span id="budgetSpent" class="budget-spent">预估¥0</span>
  </div>
  <button id="openBasket" class="basket-btn" disabled>查看食材</button>
</div>
<!-- ========== 食材与菜品 ========== -->
<div id="cartOverlay" class="cart-overlay">
    <div id="cartDrawer" class="cart-drawer">
        <div class="cart-header">
            <h3>菜品与食材</h3>
            <button id="closeCart" class="cart-close">✕</button>
        </div>
        <div class="card" id="cartContent">
    <!-- 推荐菜品 - 完全复制index.html的结构 -->
    <div class="ai-dishes-showcase">
        <div class="dishes-grid" id="dishList"></div>
    </div>

    <!-- 食材清单 - 完全复制index.html的结构 -->
    <div class="ai-dishes-showcase">
        <div class="selection-title">
            <div class="recommendation-title">食材清单</div>
        </div>
        <div class="food-list" id="ingredientList"></div>
        <div class="nutrition-tip" id="ingredientTip"></div>
    </div>

</div>
    </div>
</div>
        <!-- 微成就 -->
        <div class="achievement-bar">
            <div class="progress-container">
                <div class="progress-fill" id="progressFill" style="width: 30%"></div>
            </div>
            <div class="achievement-text" id="achievementText"></div>
        </div>
    </div>
<!--    <script src="js/load-components.js" defer></script>-->
    <!--<script src="js/load-components-in.js" defer></script>-->
    <script type="module" src="/static/js/peican.js"></script>
    <script src="/static/js/xialakimi.js"></script>

</body>
</html>